{"ast":null,"code":"\"use strict\";\n\nfunction __export(m) {\n  for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n  result[\"default\"] = mod;\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst util_1 = require(\"util\");\n\nconst stream_1 = require(\"stream\");\n\nconst fs = __importStar(require(\"fs\"));\n\nconst FormatterOptions_1 = require(\"./FormatterOptions\");\n\nconst CsvFormatterStream_1 = require(\"./CsvFormatterStream\");\n\n__export(require(\"./types\"));\n\nvar CsvFormatterStream_2 = require(\"./CsvFormatterStream\");\n\nexports.CsvFormatterStream = CsvFormatterStream_2.CsvFormatterStream;\n\nvar FormatterOptions_2 = require(\"./FormatterOptions\");\n\nexports.FormatterOptions = FormatterOptions_2.FormatterOptions;\n\nexports.format = options => new CsvFormatterStream_1.CsvFormatterStream(new FormatterOptions_1.FormatterOptions(options));\n\nexports.write = (rows, options) => {\n  const csvStream = exports.format(options);\n  const promiseWrite = util_1.promisify((row, cb) => {\n    csvStream.write(row, undefined, cb);\n  });\n  rows.reduce((prev, row) => prev.then(() => promiseWrite(row)), Promise.resolve()).then(() => csvStream.end()).catch(err => {\n    csvStream.emit('error', err);\n  });\n  return csvStream;\n};\n\nexports.writeToStream = (ws, rows, options) => exports.write(rows, options).pipe(ws);\n\nexports.writeToBuffer = (rows, opts = {}) => {\n  const buffers = [];\n  const ws = new stream_1.Writable({\n    write(data, enc, writeCb) {\n      buffers.push(data);\n      writeCb();\n    }\n\n  });\n  return new Promise((res, rej) => {\n    ws.on('error', rej).on('finish', () => res(Buffer.concat(buffers)));\n    exports.write(rows, opts).pipe(ws);\n  });\n};\n\nexports.writeToString = (rows, options) => exports.writeToBuffer(rows, options).then(buffer => buffer.toString());\n\nexports.writeToPath = (path, rows, options) => {\n  const stream = fs.createWriteStream(path, {\n    encoding: 'utf8'\n  });\n  return exports.write(rows, options).pipe(stream);\n};","map":{"version":3,"sources":["../../src/index.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst util_1 = require(\"util\");\nconst stream_1 = require(\"stream\");\nconst fs = __importStar(require(\"fs\"));\nconst FormatterOptions_1 = require(\"./FormatterOptions\");\nconst CsvFormatterStream_1 = require(\"./CsvFormatterStream\");\n__export(require(\"./types\"));\nvar CsvFormatterStream_2 = require(\"./CsvFormatterStream\");\nexports.CsvFormatterStream = CsvFormatterStream_2.CsvFormatterStream;\nvar FormatterOptions_2 = require(\"./FormatterOptions\");\nexports.FormatterOptions = FormatterOptions_2.FormatterOptions;\nexports.format = (options) => new CsvFormatterStream_1.CsvFormatterStream(new FormatterOptions_1.FormatterOptions(options));\nexports.write = (rows, options) => {\n    const csvStream = exports.format(options);\n    const promiseWrite = util_1.promisify((row, cb) => {\n        csvStream.write(row, undefined, cb);\n    });\n    rows.reduce((prev, row) => prev.then(() => promiseWrite(row)), Promise.resolve())\n        .then(() => csvStream.end())\n        .catch((err) => {\n        csvStream.emit('error', err);\n    });\n    return csvStream;\n};\nexports.writeToStream = (ws, rows, options) => exports.write(rows, options).pipe(ws);\nexports.writeToBuffer = (rows, opts = {}) => {\n    const buffers = [];\n    const ws = new stream_1.Writable({\n        write(data, enc, writeCb) {\n            buffers.push(data);\n            writeCb();\n        },\n    });\n    return new Promise((res, rej) => {\n        ws.on('error', rej).on('finish', () => res(Buffer.concat(buffers)));\n        exports.write(rows, opts).pipe(ws);\n    });\n};\nexports.writeToString = (rows, options) => exports.writeToBuffer(rows, options).then((buffer) => buffer.toString());\nexports.writeToPath = (path, rows, options) => {\n    const stream = fs.createWriteStream(path, { encoding: 'utf8' });\n    return exports.write(rows, options).pipe(stream);\n};\n//# sourceMappingURL=index.js.map"]},"metadata":{},"sourceType":"script"}